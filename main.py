"""

–ü—Ä–∏–≤–µ—Ç, –µ—Å–ª–∏ —Ç—ã - —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –≤–∑—è–≤—â–∏–π –∑–∞–∫–∞–∑, —Ç–æ —Ç—ã - –Ω–∞—Å—Ç–æ—è—â–∏–π Iron man! –ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–¥–µ–ª–∞–Ω, –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –Æ–∫–∞—Å—Å–∞, –Ω–æ
–ø–æ—á–µ–º—É-—Ç–æ –º–æ–µ–º—É –∑–∞–∫–∞–∑—á–∏–∫—É –æ—Ç–∫–∞–∑–∞–ª–∏ –≤ –µ—ë —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, —è —Å–≤–æ—é —á–∞—Å—Ç—å –≤—ã–ø–æ–ª–Ω–∏–ª, —Ç–æ –µ—Å—Ç—å —Å–¥–µ–ª–∞–ª –±–æ—Ç–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–∏–ª –æ–ø–ª–∞—Ç—É, –∞ –≤–æ—Ç –º–æ–µ–º—É
–∑–∞–∫–∞–∑—á–∏–∫—É-–º—É–¥–∞—á–∫—É –æ—á–µ–Ω—å –Ω—É–∂–Ω—ã 1000 —Ä—É–±–ª–µ–π, –æ–Ω –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ —è –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –µ–º—É 1000 —Ä—É–±–ª–µ–π(–∏–∑ 5000, –ø—Ä–∞–≤–¥–∞. –ù–æ –Ω–µ —Å—É—Ç—å), –∫–æ—Ä–æ—á–µ,
—ç—Ç–æ–º—É –ø—Ä–∏–º–∞—Ç—É –æ—Ç–∫–∞–∑–∞–ª–∏ –≤ –Æ–∫–∞—Å—Å–µ, –∏ –æ–Ω —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å anypay. –ù–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ —É AnyPay –æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ API
–ø–æ—ç—Ç–æ–º—É, —è –¥–∞–∂–µ –º—É—á–∞—Ç—å—Å—è –Ω–µ —Å—Ç–∞–ª, —Å–∫–∞–∑–∞–ª —á—Ç–æ –Ω–µ –±—É–¥—É –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∏ –Ω–∏—á–µ–≥–æ –ø–ª–∞—Ç–∏—Ç—å. –ö–æ—Ä–æ—á–µ, –∑–∞–∫–∞–∑—á–∏–∫ –ø—Ä–æ—Å—Ç–æ –∏–¥–∏–æ—Ç–∞ –∫—É—Å–æ–∫, –µ–º—É –Ω–∏—á–µ–≥–æ –Ω–µ
–ø–æ–¥—Ö–æ–¥–∏—Ç. –Ø –±—É–¥—É –æ—á–µ–Ω—å —Ä–∞–¥, –µ—Å–ª–∏ –ò–ú–ï–ù–ù–û –¢–´ –≤—ã–ø–æ–ª–Ω–∏—à—å –∑–∞–∫–∞–∑. –ï—Å–ª–∏ –∂–µ —Ç—ã –µ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—à—å, —Ç–æ, –º–æ–∂–µ—à—å –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø—Ä–∏—Å–ª–∞—Ç—å –º–Ω–µ –∫–∞–∫ –∂–µ —Ç—ã —ç—Ç–æ
—Å–¥–µ–ª–∞–ª, –≤–æ—Ç –º–æ–π —Ç–µ–ª–µ–≥—Ä–∞–º: https://t.me/AntonioMargarettiNt, —Ç—É–¥–∞ –∂–µ –ø–∏—à–∏ –ø–æ –≤—Å–µ–º –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–º –≤–æ–ø—Ä–æ—Å–∞–º. 
–£–¥–∞—á–∏ —Ç–µ–±–µ, –∞ —Å —Ç–æ–±–æ–π –±—ã–ª 15-—Ç–∏ –ª–µ—Ç–Ω–∏–π —à–∫–æ–ª—å–Ω–∏–∫. –î–∞ –ø—Ä–∏–±—É–¥–µ—Ç —Å —Ç–æ–±–æ–π –∫–æ–¥.

P.S:

–í–æ—Ç —ç—Ç–æ —è –Ω–∞–≥–æ–≤–Ω–æ–∫–æ–¥–∏–ª

"""



import logging
import sqlite3
from aiogram import Bot, Dispatcher, types
from aiogram.contrib.middlewares.logging import LoggingMiddleware
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton, ContentType

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)

# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
bot = Bot(token="6348850809:AAGaFkStZtcWslgXGupDv27jNgG8oVAJeK4")
PAYMENT_TOKEN = '1744374395:TEST:0fe170fd35e79da177dc'
dp = Dispatcher(bot)
dp.middleware.setup(LoggingMiddleware())

# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite
conn = sqlite3.connect('database.db')
cursor = conn.cursor()

# –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å —Ç—Ä–µ–º—è –∫–æ–ª–æ–Ω–∫–∞–º–∏: chat_id (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞), sum_to_buy (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞), paid (—Å—Ç—Ä–æ–∫–∏)
cursor.execute('''CREATE TABLE IF NOT EXISTS purchases
                  (chat_id INTEGER, sum_to_buy INTEGER, user_id_game INT, paid TEXT)''')
conn.commit()

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã "/start"
@dp.message_handler(commands=['start'])
async def send_welcome(message: types.Message):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ –∑–∞–ø–∏—Å—å —Å –¥–∞–Ω–Ω—ã–º chat_id
    cursor.execute("SELECT * FROM purchases WHERE chat_id=?", (message.chat.id,))
    existing_entry = cursor.fetchone()
    if existing_entry:
        # –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
        keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
        button_about_us = KeyboardButton("‚ÑπÔ∏è–û –Ω–∞—Å")
        button_buy_currency = KeyboardButton("üíµ–ü–æ–∫—É–ø–∫–∞ –≤–∞–ª—é—Ç—ã")
        button_reviews = KeyboardButton("üî•–û—Ç–∑—ã–≤—ã")
        keyboard.add(button_about_us, button_buy_currency, button_reviews)
        
        await message.answer("–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, –¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –≤–∞–ª—é—Ç—ã", reply_markup=keyboard)
    else:
        # –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        cursor.execute("INSERT INTO purchases (chat_id) VALUES (?)", (message.chat.id,))
        conn.commit()
        
        keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
        button_about_us = KeyboardButton("–û –Ω–∞—Å")
        button_buy_currency = KeyboardButton("üíµ–ü–æ–∫—É–ø–∫–∞ –≤–∞–ª—é—Ç—ã")
        button_reviews = KeyboardButton("üî•–û—Ç–∑—ã–≤—ã")
        keyboard.add(button_about_us, button_buy_currency, button_reviews)
        
        await message.answer("–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, –¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –≤–∞–ª—é—Ç—ã", reply_markup=keyboard)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–æ–∫—É–ø–∫–∞ –≤–∞–ª—é—Ç—ã"
@dp.message_handler(text="üíµ–ü–æ–∫—É–ø–∫–∞ –≤–∞–ª—é—Ç—ã")
async def buy_currency(message: types.Message):
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤—ã–±–æ—Ä–æ–º —Å—É–º–º—ã –≤–∞–ª—é—Ç—ã
    keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    keyboard.add(KeyboardButton("2400 üí∞"))
    keyboard.add(KeyboardButton("5400 üí∞"))
    keyboard.add(KeyboardButton("10800 üí∞"))
    keyboard.add(KeyboardButton("21200 üí∞"))
    keyboard.add(KeyboardButton("42400 üí∞"))
    keyboard.add(KeyboardButton("Go Back"))

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –≤—ã–±–æ—Ä–∞ —Å—É–º–º—ã –≤–∞–ª—é—Ç—ã –∏ –∫–∞—Ä—Ç–∏–Ω–∫—É
    await message.answer_photo(photo="https://i0.wp.com/news.seagm.com/wp-content/uploads/2023/04/CODM-CPCodeGlobal-featuredimage-1200x675-1.jpg?fit=1200%2C675&ssl=1",
                               caption="üìãPrice –ª–∏—Å—Ç:\n ü™ô2400 CP - 1350 –†—É–±–ª–µ–π.\n ü™ô5400 CP - 1350 –†—É–±–ª–µ–π.\n ü™ô10800 CP - 5000 –†—É–±–ª–µ–π.\n ü™ô21200 CP - 9500 –†—É–±–ª–µ–π.\n ü™ô42400 CP - 18700 –†—É–±–ª–µ–π.",
                               reply_markup=keyboard)
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ —Å—É–º–º—É –≤–∞–ª—é—Ç—ã:", reply_markup=keyboard)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫–∏ —Å—É–º–º—ã –≤–∞–ª—é—Ç—ã
@dp.message_handler(text=["2400 üí∞", "5400 üí∞", "10800 üí∞", "21200 üí∞", "42400 üí∞"])
async def select_currency_amount(message: types.Message):
    # –ú–∞–ø–ø–∏–Ω–≥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è CP –∫ G
    cp_to_g = {
        "2400 üí∞": 1350,
        "5400 üí∞": 2800,
        "10800 üí∞": 5000,
        "21200 üí∞": 9500,
        "42400 üí∞": 18700
    }
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–ª—é—Ç—ã –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏
    currency_amount = cp_to_g[message.text]
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ sum_to_buy –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("UPDATE purchases SET sum_to_buy=? WHERE chat_id=?", (currency_amount, message.chat.id))
    conn.commit()
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –µ–≥–æ –≤—ã–±–æ—Ä —É—á—Ç–µ–Ω
    await message.answer(f"–í—ã –≤—ã–±—Ä–∞–ª–∏ {message.text}. –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–∫–∏: {currency_amount} —Ä—É–±–ª–µ–π.")
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ–≥–æ –∏–≥—Ä–æ–≤–æ–π ID
    await message.answer("üÜî–£–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π id –∏–∑ –∏–≥—Ä—ã:")
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    dp.register_message_handler(get_user_id_game, state="*")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
async def get_user_id_game(message: types.Message):
    # –ü–æ–ª—É—á–∞–µ–º –∏–≥—Ä–æ–≤–æ–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_id_game = message.text
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ user_id_game –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("UPDATE purchases SET user_id_game=? WHERE chat_id=?", (user_id_game, message.chat.id))
    conn.commit()
    
    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
    await dp.current_state().reset_state()

    # –°–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ –µ–≥–æ –∏–≥—Ä–æ–≤–æ–π ID —Å–æ—Ö—Ä–∞–Ω–µ–Ω
    await message.answer("–í–∞—à –∏–≥—Ä–æ–≤–æ–π ID —Å–æ—Ö—Ä–∞–Ω–µ–Ω. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å. –í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /buy –¥–ª—è –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞.")


@dp.message_handler(text='import this')
async def show_python_philosophy(message: types.Message):
    await message.answer_photo(photo='https://upload.wikimedia.org/wikipedia/commons/thumb/f/f4/Zen_Of_Python.png/300px-Zen_Of_Python.png', caption='–ö—Ä–∞—Å–∏–≤–æ–µ –ª—É—á—à–µ, —á–µ–º —É—Ä–æ–¥–ª–∏–≤–æ–µ. –Ø–≤–Ω–æ–µ –ª—É—á—à–µ, —á–µ–º –Ω–µ—è–≤–Ω–æ–µ.\n–ü—Ä–æ—Å—Ç–æ–µ –ª—É—á—à–µ, —á–µ–º —Å–ª–æ–∂–Ω–æ–µ.\n–°–ª–æ–∂–Ω–æ–µ –ª—É—á—à–µ, —á–µ–º –∑–∞–ø—É—Ç–∞–Ω–Ω–æ–µ.\n–ü–ª–æ—Å–∫–æ–µ –ª—É—á—à–µ, —á–µ–º –≤–ª–æ–∂–µ–Ω–Ω–æ–µ.\n–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ –ª—É—á—à–µ, —á–µ–º –ø–ª–æ—Ç–Ω–æ–µ.\n–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ.\n–û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏ –Ω–µ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –æ—Å–æ–±—ã–µ, —á—Ç–æ–±—ã –Ω–∞—Ä—É—à–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞.\n–ü—Ä–∏ —ç—Ç–æ–º –ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –±–µ–∑—É–ø—Ä–µ—á–Ω–æ—Å—Ç–∏.\n–û—à–∏–±–∫–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–º–∞–ª—á–∏–≤–∞—Ç—å—Å—è.\n–ï—Å–ª–∏ –æ–Ω–∏ –Ω–µ –∑–∞–º–∞–ª—á–∏–≤–∞—é—Ç—Å—è —è–≤–Ω–æ.\n–í—Å—Ç—Ä–µ—Ç–∏–≤ –¥–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç—å, –æ—Ç–±—Ä–æ—Å—å –∏—Å–∫—É—à–µ–Ω–∏–µ —É–≥–∞–¥–∞—Ç—å.\n–î–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏, –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ—á–µ–≤–∏–¥–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ.\n–•–æ—Ç—è –æ–Ω –ø–æ–Ω–∞—á–∞–ª—É –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –Ω–µ –æ—á–µ–≤–∏–¥–µ–Ω, –µ—Å–ª–∏ –≤—ã –Ω–µ –≥–æ–ª–ª–∞–Ω–¥–µ—Ü.\n–°–µ–π—á–∞—Å –ª—É—á—à–µ, —á–µ–º –Ω–∏–∫–æ–≥–¥–∞.\n–•–æ—Ç—è –Ω–∏–∫–æ–≥–¥–∞ –∑–∞—á–∞—Å—Ç—É—é –ª—É—á—à–µ, —á–µ–º –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.\n–ï—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–ª–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å ‚Äî –∏–¥–µ—è –ø–ª–æ—Ö–∞.\n–ï—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ª–µ–≥–∫–æ –æ–±—ä—è—Å–Ω–∏—Ç—å ‚Äî –∏–¥–µ—è, –≤–æ–∑–º–æ–∂–Ω–æ, —Ö–æ—Ä–æ—à–∞.\n–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è —à—Ç—É–∫–∞!\n–ë—É–¥–µ–º –¥–µ–ª–∞—Ç—å –∏—Ö –±–æ–ª—å—à–µ!')

from aiogram import types

from aiogram.types import LabeledPrice

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /buy
@dp.message_handler(commands=['buy'])
async def process_buy_command(message: types.Message):
    # –ü–æ–ª—É—á–∞–µ–º —Å—É–º–º—É –¥–ª—è –æ–ø–ª–∞—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("SELECT sum_to_buy FROM purchases WHERE chat_id=?", (message.chat.id,))
    sum_to_buy = cursor.fetchone()[0]
    
    await bot.send_message(message.chat.id, "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂!!!")

    # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç LabeledPrice –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–∞
    labeled_price = LabeledPrice(label="–ü–æ–∫—É–ø–∫–∞ –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã", amount=sum_to_buy * 100)

    await bot.send_invoice(message.chat.id, 
                           title="–ü–æ–∫—É–ø–∫—É –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã",
                           description="–ü–æ–∫—É–ø–∫–∞ –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã Call Of Duty",
                           provider_token= PAYMENT_TOKEN, 
                           currency='rub', 
                           photo_url='https://blz-contentstack-images.akamaized.net/v3/assets/bltf408a0557f4e4998/bltd31831eda9199937/62abc0df5cbe472513c0ce59/Cortez_Base_Game-Bnet_Game-Card_Feature-960x540.jpg',
                           photo_width=416,
                           photo_height=234,
                           photo_size=416,
                           is_flexible=False, 
                           prices=[labeled_price],  # –ü–µ—Ä–µ–¥–∞–µ–º –æ–±—ä–µ–∫—Ç LabeledPrice –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞
                           start_parameter='gold-call-of',
                           payload='test-invoice-payload')

@dp.pre_checkout_query_handler(lambda query: True)
async def pre_checkout_query(pre_checkout_q: types.PreCheckoutQuery):
    await bot.answer_pre_checkout_query(pre_checkout_q.id, ok=True)

@dp.message_handler(content_types=ContentType.SUCCESSFUL_PAYMENT)
async def successeful_payment(message: types.Message):
    print("SUCCESSEFUL PAYMENT:")
    payment_info = message.successful_payment.to_python()
    for key, value in payment_info.items():
        print(f"{key} == {value}")
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–∫—É–ø–∫–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("SELECT user_id_game, paid, sum_to_buy FROM purchases WHERE chat_id=?", (message.chat.id,))
    user_id_game, paid, sum_to_buy = cursor.fetchone()

    # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("UPDATE purchases SET paid=? WHERE chat_id=?", ("yes", message.chat.id))
    conn.commit()

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–ª–∞—Ç–µ–∂–µ
    await bot.send_message(
        "1921428012",  # –í–∞—à Telegram ID
        f"–ü—Ä–æ—à–ª–∞ –æ–ø–ª–∞—Ç–∞:\n"
        f"id –∏–≥—Ä–æ–∫–∞: {user_id_game}\n"
        f"–æ–ø–ª–∞—á–µ–Ω–æ: yes\n"
        f"chat_id: {message.chat.id}\n"
        f"–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É–ø–ª–µ–Ω–Ω–æ–π –≤–∞–ª—é—Ç—ã: {sum_to_buy}"
    )
    await bot.send_message(message.chat.id, "üü¢–û—Ç–ª–∏—á–Ω–æ, –ø–ª–∞—Ç—ë–∂ –ø—Ä–æ—à—ë–ª! ‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ 10 –º–∏–Ω—É—Ç –¥–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞!")



'''# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
@dp.message_handler(content_types=types.ContentType.SUCCESSFUL_PAYMENT)
async def process_successful_payment(message: types.Message):
    # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    cursor.execute("UPDATE purchases SET paid=? WHERE chat_id=?", ("yes", message.chat.id))
    conn.commit()
    
    # –°–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ –æ–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
    await message.answer("–û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ. –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!")'''

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "Go Back"
@dp.message_handler(text="Go Back")
async def go_back(message: types.Message):
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–∞–º–∏
    keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    button_about_us = KeyboardButton("‚ÑπÔ∏è–û –Ω–∞—Å")
    button_buy_currency = KeyboardButton("üíµ–ü–æ–∫—É–ø–∫–∞ –≤–∞–ª—é—Ç—ã")
    button_reviews = KeyboardButton("üî•–û—Ç–∑—ã–≤—ã")
    keyboard.add(button_about_us, button_buy_currency, button_reviews)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
    await message.answer(text='–í–µ—Ä–Ω—É–ª–∏—Å—å –æ–±—Ä–∞—Ç–Ω–æ', reply_markup=keyboard)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–û –Ω–∞—Å"
@dp.message_handler(text="‚ÑπÔ∏è–û –Ω–∞—Å")
async def send_about_us_info(message: types.Message):
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—Å
    await message.answer("–î–æ–±—Ä–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫\n–í –Ω–∞—à–µ–º –º–∞–≥–∞–∑–∏–Ω–µ —Ç—ã –º–æ–∂–µ—à—å –∫—É–ø–∏—Ç—å –≤–∞–ª—é—Ç—É Call of Dute CP.\n–ú–∞–≥–∞–∑–∏–Ω–∞ –ê–∫–∫–∞—É–Ω—Ç–æ–≤  https://t.me/AccountBes\n–í–ª–∞–¥–µ–ª–µ—Ü  @garant_eremenko\n–ì–∞—Ä–∞–Ω—Ç–∏–∏ https://vk.com/wall-207631280_1\n–ì–æ–≤–æ—Ä–∏—Ç–µ –∑–∞ –Ω–∞—Å –¥—Ä—É–∑—å—è–º, –±—É–¥–µ–º —Ä–∞–¥—ã, —Ç–∞–∫ –∂–µ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –æ—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–∑—ã–≤—ã –≤–æ –≤–∫–ª–∞–¥–∫–µ - –æ—Ç–∑—ã–≤—ã üòÖ\n–ò –æ—Å—Ç–µ—Ä–µ–≥–∞–π—Ç–µ—Å—å –§–µ–π–∫–æ–≤ –ë—É–¥—å—Ç–µ –±–¥–∏—Ç–µ–ª—å–Ω—ã.\n–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ, —Ö–æ—Ä–æ—à–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è, –∏ –ø–æ–∑–∏—Ç–∏–≤–∞ üòá")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–û—Ç–∑—ã–≤—ã"
@dp.message_handler(text="üî•–û—Ç–∑—ã–≤—ã")
async def send_reviews(message: types.Message):
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–∑—ã–≤—ã
    await message.answer("ü´°–¢—É—Ç –æ—Ç–∑—ã–≤—ã –æ –Ω–∞—Å üëâ https://t.me/cp_donat_otzivi/2 üëà")

# –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
if __name__ == '__main__':
    import asyncio
    from aiogram import executor
    loop = asyncio.get_event_loop()
    executor.start_polling(dp, loop=loop, skip_updates=True)





